{
  "swagger" : "2.0",
  "info" : {
    "version" : "v1",
    "title" : "KS Fiks: Samtykke Avtale Service",
    "contact" : {
      "name" : "Fiks-brukerstøtte",
      "url" : "https://ks-no.github.io/",
      "email" : "fiks-utvikling@ks.no"
    }
  },
  "host" : "api.fiks.test.ks.no",
  "basePath" : "/",
  "tags" : [ {
    "name" : "Avtale"
  }, {
    "name" : "Samtykke"
  } ],
  "schemes" : [ "https" ],
  "paths" : {
    "/avtale/api/v1/{fiksOrgId}/avtaler" : {
      "get" : {
        "tags" : [ "Avtale" ],
        "summary" : "Hent alle avtaler på spesifisert organisasjon. Krever ADMIN autorisering på organisasjonen",
        "description" : "",
        "operationId" : "getAvtaler",
        "parameters" : [ {
          "name" : "fiksOrgId",
          "in" : "path",
          "required" : true,
          "type" : "string",
          "format" : "uuid"
        } ],
        "responses" : {
          "200" : {
            "description" : "successful operation",
            "schema" : {
              "type" : "array",
              "items" : {
                "$ref" : "#/definitions/AvtaleApiModel"
              },
              "uniqueItems" : true
            }
          }
        }
      },
      "post" : {
        "tags" : [ "Avtale" ],
        "summary" : "Opprett en ny avtale. Krever ADMIN autorisering på organisasjonen",
        "description" : "",
        "operationId" : "opprettAvtale",
        "parameters" : [ {
          "name" : "fiksOrgId",
          "in" : "path",
          "required" : true,
          "type" : "string",
          "format" : "uuid"
        }, {
          "in" : "body",
          "name" : "body",
          "required" : false,
          "schema" : {
            "$ref" : "#/definitions/AvtaleSpesifikasjon"
          }
        } ],
        "responses" : {
          "200" : {
            "description" : "successful operation",
            "schema" : {
              "$ref" : "#/definitions/AvtaleApiModel"
            }
          }
        }
      }
    },
    "/avtale/api/v1/{fiksOrgId}/avtaler/avtaleTekst/{avtaleId}" : {
      "get" : {
        "tags" : [ "Avtale" ],
        "summary" : "Hent avtaletekst i html format for spesifisert avtale. Hvis avtalen er aktiv kan alle autentiserte brukere hente den, hvis ikke må du være autorisert som ADMIN på den aktuelle organisasjonen",
        "description" : "",
        "operationId" : "getAvtaleTekst",
        "parameters" : [ {
          "name" : "fiksOrgId",
          "in" : "path",
          "required" : true,
          "type" : "string",
          "format" : "uuid"
        }, {
          "name" : "avtaleId",
          "in" : "path",
          "required" : true,
          "type" : "string",
          "format" : "uuid"
        } ],
        "responses" : {
          "200" : {
            "description" : "successful operation",
            "schema" : {
              "$ref" : "#/definitions/AvtaleTekst"
            }
          }
        }
      }
    },
    "/avtale/api/v1/{fiksOrgId}/avtaler/{avtaleId}" : {
      "get" : {
        "tags" : [ "Avtale" ],
        "summary" : "Hent en spesifikk avtale. Krever ADMIN autorisering på organisasjonen",
        "description" : "",
        "operationId" : "getAvtale",
        "parameters" : [ {
          "name" : "fiksOrgId",
          "in" : "path",
          "required" : true,
          "type" : "string",
          "format" : "uuid"
        }, {
          "name" : "avtaleId",
          "in" : "path",
          "required" : true,
          "type" : "string",
          "format" : "uuid"
        } ],
        "responses" : {
          "200" : {
            "description" : "successful operation",
            "schema" : {
              "$ref" : "#/definitions/AvtaleApiModel"
            }
          }
        }
      },
      "put" : {
        "tags" : [ "Avtale" ],
        "summary" : "Oppdater en eksisterende avtale. Merk at avtaler som er aktiv eller arkivert ikke kan oppdateres. Krever ADMIN autorisering på organisasjonen",
        "description" : "",
        "operationId" : "oppdaterAvtale",
        "parameters" : [ {
          "name" : "fiksOrgId",
          "in" : "path",
          "required" : true,
          "type" : "string",
          "format" : "uuid"
        }, {
          "name" : "avtaleId",
          "in" : "path",
          "required" : true,
          "type" : "string",
          "format" : "uuid"
        }, {
          "in" : "body",
          "name" : "body",
          "required" : false,
          "schema" : {
            "$ref" : "#/definitions/AvtaleSpesifikasjon"
          }
        } ],
        "responses" : {
          "200" : {
            "description" : "successful operation",
            "schema" : {
              "$ref" : "#/definitions/AvtaleApiModel"
            }
          }
        }
      },
      "delete" : {
        "tags" : [ "Avtale" ],
        "summary" : "Slett en eksisterende avtale. Merk at avtaler som er aktiv eller arkivert ikke kan slettes. Krever ADMIN autorisering på organisasjonen",
        "description" : "",
        "operationId" : "slettAvtale",
        "parameters" : [ {
          "name" : "fiksOrgId",
          "in" : "path",
          "required" : true,
          "type" : "string",
          "format" : "uuid"
        }, {
          "name" : "avtaleId",
          "in" : "path",
          "required" : true,
          "type" : "string",
          "format" : "uuid"
        } ],
        "responses" : {
          "default" : {
            "description" : "successful operation"
          }
        }
      }
    },
    "/avtale/api/v1/{fiksOrgId}/avtaler/{avtaleId}/aktiver" : {
      "post" : {
        "tags" : [ "Avtale" ],
        "summary" : "Aktiver en avtale. Avtaleteksten blir da tilgjengelig for autentiserte brukere, og disse kan samtykke til eller avise avtalen. Merk at aktiverte avtaler ikke kan slettes eller oppdateres. Krever ADMIN autorisering på organisasjonen",
        "description" : "",
        "operationId" : "aktiverAvtale",
        "parameters" : [ {
          "name" : "fiksOrgId",
          "in" : "path",
          "required" : true,
          "type" : "string",
          "format" : "uuid"
        }, {
          "name" : "avtaleId",
          "in" : "path",
          "required" : true,
          "type" : "string",
          "format" : "uuid"
        } ],
        "responses" : {
          "200" : {
            "description" : "successful operation",
            "schema" : {
              "$ref" : "#/definitions/AvtaleApiModel"
            }
          }
        }
      }
    },
    "/avtale/api/v1/{fiksOrgId}/avtaler/{avtaleId}/arkiver" : {
      "post" : {
        "tags" : [ "Avtale" ],
        "summary" : "Arkiver en avtale. Avtaleteksten vi da bli utilgjengelig for autentiserte brukere, og det vil ikke lengre være mulig for brukere å samtykke eller avvise avtalen",
        "description" : "",
        "operationId" : "arkiverAvtale",
        "parameters" : [ {
          "name" : "fiksOrgId",
          "in" : "path",
          "required" : true,
          "type" : "string",
          "format" : "uuid"
        }, {
          "name" : "avtaleId",
          "in" : "path",
          "required" : true,
          "type" : "string",
          "format" : "uuid"
        } ],
        "responses" : {
          "200" : {
            "description" : "successful operation",
            "schema" : {
              "$ref" : "#/definitions/AvtaleApiModel"
            }
          }
        }
      }
    },
    "/samtykke/api/v1/{fiksOrgId}/samtykkeStatus" : {
      "get" : {
        "tags" : [ "Samtykke" ],
        "summary" : "Hent status på en persons samtykke for avtaler innenfor en avtalekode. For å kunne hente status samtykkeerlæringen enten være opprettet av brukeren som er autentisert på denne forespørselen, eller brukeren må ha ADMIN privelegiet på organisasjonen samtykke tilhører.",
        "description" : "",
        "operationId" : "getSamtykkeStatus",
        "parameters" : [ {
          "name" : "fiksOrgId",
          "in" : "path",
          "required" : true,
          "type" : "string",
          "format" : "uuid"
        }, {
          "name" : "avtaleKode",
          "in" : "query",
          "required" : true,
          "type" : "string"
        }, {
          "name" : "fnr",
          "in" : "query",
          "required" : true,
          "type" : "string"
        } ],
        "responses" : {
          "200" : {
            "description" : "successful operation",
            "schema" : {
              "$ref" : "#/definitions/SamtykkeStatusApiModel"
            }
          }
        }
      }
    },
    "/samtykke/api/v1/{fiksOrgId}/samtykkeerklaeringer" : {
      "get" : {
        "tags" : [ "Samtykke" ],
        "summary" : "Hent samtykkeerklæringer. For å hente en erklæring må den enten være opprettet av brukeren som er autentisert på denne forespørselen, ellers må brukeren ha ADMIN privelegiet på organisasjonen samtykke tilhører",
        "description" : "",
        "operationId" : "getSamtykke",
        "parameters" : [ {
          "name" : "fiksOrgId",
          "in" : "path",
          "required" : true,
          "type" : "string",
          "format" : "uuid"
        }, {
          "name" : "avtaleKode",
          "in" : "query",
          "required" : false,
          "type" : "string"
        }, {
          "name" : "fnr",
          "in" : "query",
          "required" : false,
          "type" : "string"
        } ],
        "responses" : {
          "200" : {
            "description" : "successful operation",
            "schema" : {
              "type" : "array",
              "items" : {
                "$ref" : "#/definitions/SamtykkeErklaeringApiModel"
              },
              "uniqueItems" : true
            }
          }
        }
      },
      "post" : {
        "tags" : [ "Samtykke" ],
        "summary" : "Opprett samtykke. Merk at man bare kan samtykke til aktive avtaler. Det er bare mulig å samtykke på vegne av brukeren som er autentisert på forespørselen.",
        "description" : "",
        "operationId" : "opprettSamtykke",
        "parameters" : [ {
          "name" : "fiksOrgId",
          "in" : "path",
          "required" : true,
          "type" : "string",
          "format" : "uuid"
        }, {
          "in" : "body",
          "name" : "body",
          "required" : false,
          "schema" : {
            "$ref" : "#/definitions/SamtykkeErklaeringSpesifikasjon"
          }
        } ],
        "responses" : {
          "200" : {
            "description" : "successful operation",
            "schema" : {
              "$ref" : "#/definitions/SamtykkeErklaeringApiModel"
            }
          }
        }
      }
    }
  },
  "definitions" : {
    "AvtaleApiModel" : {
      "type" : "object",
      "properties" : {
        "avtaleId" : {
          "type" : "string",
          "format" : "uuid",
          "description" : "Unik identifikator for avtalen"
        },
        "fiksOrgId" : {
          "type" : "string",
          "format" : "uuid",
          "description" : "Unik identifikator for fiks-organisasjonen som eier avtalen"
        },
        "avtaleDato" : {
          "type" : "string",
          "format" : "date",
          "description" : "Datoen avtalen ble aktivert (gjort tilgjengelig for brukere)"
        },
        "avtaleKode" : {
          "type" : "string",
          "description" : "Kode for avtalen. Flere avtaler kan dele samme kode, men bare en kan være aktiv til enhver tid"
        },
        "avtaleStatus" : {
          "type" : "string",
          "description" : "Status for avtalen. INAKTIV betyr at avtalen eksisterer som \"kladd\". AKTIV betyr at dette er gjeldene versjon for den spesifiserte avtalekoden. ARKIVERT betyr at avtalen en gang har vært aktiv, men nå ikke lengre er gjeldende for avtalekoden, endten fordi det er laget en nyere versjon eller fordi avtalekoden ikke har noen aktiv avtale.  Samtykkeerklæringer kan bare opprettes for aktive avtaler",
          "enum" : [ "INAKTIV", "AKTIV", "ARKIVERT" ]
        }
      }
    },
    "AvtaleSpesifikasjon" : {
      "type" : "object",
      "properties" : {
        "avtaleKode" : {
          "type" : "string",
          "description" : "Kode for en avtaletype. Flere avtaler kan dele kode, men bare en av disse kan være aktiv til enhver tid."
        },
        "avtaleMarkdown" : {
          "type" : "string",
          "description" : "Avtaletekst i markdown format. Konverteres til html ved visning."
        }
      }
    },
    "AvtaleTekst" : {
      "type" : "object",
      "properties" : {
        "avtaleId" : {
          "type" : "string",
          "format" : "uuid"
        },
        "html" : {
          "type" : "string"
        }
      }
    },
    "SamtykkeErklaeringApiModel" : {
      "type" : "object",
      "properties" : {
        "samtykkeErklaeringId" : {
          "type" : "string",
          "format" : "uuid",
          "description" : "Unik identifikator for en samtykkeerklæring"
        },
        "fiksOrgId" : {
          "type" : "string",
          "format" : "uuid",
          "description" : "Unik identifikator for fiks-organisasjonen som eier avtalen en samtykkeerklæring er knyttet til"
        },
        "avtale" : {
          "description" : "Avtalen en samtykkeerklæring er knyttet til",
          "$ref" : "#/definitions/AvtaleApiModel"
        },
        "status" : {
          "type" : "string",
          "description" : "Status, kan være AKSEPTERT eller AVVIST",
          "enum" : [ "AKSEPTERT", "AVVIST" ]
        },
        "samtykkeTidspunkt" : {
          "type" : "string",
          "format" : "date-time",
          "description" : "Tidspunktet samtykket ble opprettet"
        }
      }
    },
    "SamtykkeErklaeringSpesifikasjon" : {
      "type" : "object",
      "required" : [ "avtaleId" ],
      "properties" : {
        "avtaleId" : {
          "type" : "string",
          "format" : "uuid",
          "description" : "Unik identifikator for avtalen samtykkeerklæringen gjelder"
        },
        "status" : {
          "type" : "string",
          "description" : "Status for samtykket: aksepterer eller avviser brukeren avtalen",
          "enum" : [ "AKSEPTERT", "AVVIST" ]
        }
      }
    },
    "SamtykkeStatusApiModel" : {
      "type" : "object",
      "properties" : {
        "aktivAvtale" : {
          "description" : "Den nåværende aktive avtalen på den spesifiserte avtalekoden. Hvis det ikke finnes aktive avtaler vil denne være null",
          "$ref" : "#/definitions/AvtaleApiModel"
        },
        "aktivtSamtykke" : {
          "description" : "Den spesifiserte brukerens samtykkeerklæring for den aktive avtalen. Hvis brukeren ikke har vurdert den aktive avtalen, eller vis avtalekoden ikke har en aktiv avtale, vil denne være null",
          "$ref" : "#/definitions/SamtykkeErklaeringApiModel"
        },
        "sisteSamtykke" : {
          "description" : "Det siste samtykket inngått av brukeren på den spesifiserte avtalekoden. Vil være null om brukeren ikke har inngått noen samtykker.",
          "$ref" : "#/definitions/SamtykkeErklaeringApiModel"
        }
      }
    }
  }
}